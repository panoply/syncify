{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "syncify",
  "version": 1.1,
  "definitions": {
    "stores": {
      "type": "array",
      "title": "Stores",
      "additionalProperties": false,
      "description": "List of Shopify stores to connect",
      "items": {
        "type": "object",
        "required": ["domain", "themes"],
        "properties": {
          "domain": {
            "description": "Do not include the \"myshopify.com\" portion of the domain.",
            "type": "string",
            "pattern": "^[a-zA-Z0-9_-]+$"
          },
          "themes": {
            "description": "An object list of theme maps where the key properties represent a theme target names and their values the theme id.",
            "examples": [
              {
                "dev": 123456789
              }
            ],
            "type": "object",
            "propertyNames": {
              "pattern": "^[a-z0-9_$-]{1,15}$",
              "description": "Property keys will be used as target references by the CLI. The theme target name cannot contain spaces and cannot exceed 15 characters"
            }
          }
        }
      }
    },
    "paths": {
      "type": "object",
      "title": "Paths",
      "additionalProperties": false,
      "description": "Customize the development theme structure of your project. You can create path maps to different locations within your project and Syncify will re-route them to the accepted theme structure imposed by Shopify. You cannot define reverse paths and globs must be relative to your root directory.\n\nAll paths must point to directories and files contained within the \"source\" directory defined. You can optionally omit the \"source\" entry from paths as Syncify will normalize and prepend that to all values defined.",
      "properties": {
        "assets": {
          "description": "Paths to files to be published to theme \"/assets\" directory. Accepts a glob (anymatch) pattern.",
          "type": "array",
          "items": {
            "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[!*a-zA-Z0-9_-]{1,}){1,}([.a-z]{1,})?$",
            "type": "string"
          }
        },
        "config": {
          "description": "Paths to files to be published to the theme \"/config\" directory. These are typically the \"settings_schema.json\" and \"settings_data.json\" files.",
          "type": "array",
          "items": {
            "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[!*a-zA-Z0-9_-]{1,}){1,}([.a-z]{1,})?$",
            "type": "string"
          }
        },
        "locales": {
          "description": "Paths to files to be published to theme \"/locales\" directory. These are the translation files used by your store.",
          "type": "array",
          "items": {
            "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[!*a-zA-Z0-9_-]{1,}){1,}([.a-z]{1,})?$",
            "type": "string"
          }
        },
        "layout": {
          "description": "Paths to files to be published to the theme \"/layout\" directory. These are Liquid template files.",
          "type": "array",
          "items": {
            "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[!*a-zA-Z0-9_-]{1,}){1,}([.a-z]{1,})?$",
            "type": "string"
          }
        },
        "snippets": {
          "description": "Paths to files to be published to the theme \"/snippets\" directory. These are Liquid template files.",
          "type": "array",
          "items": {
            "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[!*a-zA-Z0-9_-]{1,}){1,}([.a-z]{1,})?$",
            "type": "string"
          }
        },
        "sections": {
          "description": "Paths to files to be published to the theme \"/sections\" directory. These are Liquid template files.\n\nYou can provide sub-directory references here and Syncify will re-path values. See the \"views.sections\" options to control how sections should be output.",
          "type": "array",
          "items": {
            "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[!*a-zA-Z0-9_-]{1,}){1,}([.a-z]{1,})?$",
            "type": "string"
          }
        },
        "templates": {
          "description": "Paths to files to be published to the theme \"/templates\" directory.. These can be either JSON or Liquid template files.",
          "type": "array",
          "items": {
            "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[!*a-zA-Z0-9_-]{1,}){1,}([.a-z]{1,})?$",
            "type": "string"
          }
        },
        "customers": {
          "description": "Paths to files to be published to the theme \"/templates/customers\" directory. directory. These can be either JSON or Liquid template files.",
          "type": "array",
          "items": {
            "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[!*a-zA-Z0-9_-]{1,}){1,}([.a-z]{1,})?$",
            "type": "string"
          }
        }
      }
    },
    "dirs": {
      "type": "object",
      "additionalProperties": false,
      "description": "Configures the build directory base paths of your project. The options defined here will be used in watch, build, upload and download modes. You cannot define reverse paths or sub-directory paths. All values must be relative to root directory.",
      "properties": {
        "source": {
          "type": "string",
          "default": "source",
          "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[a-zA-Z0-9_-]{1,}){0,}$",
          "description": "The source build path is the directory where theme files exist. Syncify defaults this to \"source\". The value defined here will be prepended to any path you define within \"paths\"."
        },
        "output": {
          "type": "string",
          "default": "theme",
          "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[a-zA-Z0-9_-]{1,}){0,}$",
          "description": "The output build path is the directory where transformed theme files will be written. This is typically called \"dist\" in most projects but Syncify defaults this to \"theme\". The output directory will reflect the theme files synced with your store online."
        },
        "import": {
          "type": "string",
          "default": "import",
          "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[a-zA-Z0-9_-]{1,}){0,}$",
          "description": "The import build path is the directory where downloaded themes and files will be written. It is relative to your projects root directory and only used in the download mode."
        },
        "export": {
          "type": "string",
          "default": "import",
          "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[a-zA-Z0-9_-]{1,}){0,}$",
          "description": "The export path is where packaged (.zip) themes will be written when running the \"package\" resource. Packaged themes will be prepended with the version number defined in your \"package.json\" file and are exported as \".zip\" files."
        },
        "config": {
          "type": "string",
          "default": "config",
          "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[a-zA-Z0-9_-]{1,}){0,}$",
          "description": "Syncify will look for configuration files in the root of your project but this might not always be ideal as it can create clutter in your workspace. You can optionally place these config files within a sub-directory (relative to root) and Syncify will look for any spawned of config files from within this directory (opposed to root). \n\nTypically this is named \"scripts\" in most node projects, you can place config files like you \"rollup.config.js\" or \"postcss.config.js\" files within."
        },
        "metafields": {
          "description": "The directory path to global shop metafields. Syncify provides a elegant approach to metafield synchronization using a directory > file based structure.",
          "type": "string",
          "pattern": "^[a-zA-Z0-9_-]{1,}(\\/[a-zA-Z0-9_-]{1,}){0,}$"
        }
      }
    },
    "spawn": {
      "type": "object",
      "additionalProperties": false,
      "description": "Spawned child processes to run in parallel with the Syncify resource instance. Supply the CLI command of the process to execute.\n\nYou can leverage Syncify utilities and environment variables to conditionally execute different builds, eg: production or development.",
      "properties": {
        "watch": {
          "type": "object",
          "description": "Supply the script commands you wish to spawn in watch mode. The \"key\" value will be used as the group reference in the CLI logs."
        },
        "build": {
          "type": "object",
          "description": "Supply the script commands you wish to spawn in build mode. Build mode will trigger spawns in resource modes such as \"upload\" and \"build\". The \"key\" value will be used as the group reference in the CLI logs.\n\nBuild spawns will execute only once."
        }
      }
    },
    "styles": {
      "description": "A list of SCSS or SASS stylesheets to transform. Files will be processed with \"Dart SASS\" and compiled contents will be passed to PostCSS for post-processing if you have PostCSS installed and your project contains a \"postcss.config.js\" file.\n\nYou can also define \".css\" files to be processed in accordance.",
      "type": "array",
      "items": {
        "required": ["input"],
        "type": "object",
        "properties": {
          "input": {
            "oneOf": [
              {
                "description": "Input path to a stylesheet, eg: \"styles/stylesheet.scss\". This is the root SCSS file from which @imports or @use is called. When changes are detected Syncify will trigger the build from this file. Any \"watch\" files referenced will trigger this file on rebuild.",
                "type": "string"
              },
              {
                "description": "List on input paths or glob patterns of stylesheets to process, for example:\n\n[\n\t\"styles/dir/*.scss\",\n\t\"styles/vendors/framework.css\"\n]\n\nIf you define \".scss\" or \".sass\" styles they will be processed with Dart SASS. If you have PostCSS installed and your project contains a \"postcss.config.js\" file then compiled \".scss\" and \".sass\" file contents will be passed to PostCSS.",
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          },
          "watch": {
            "description": "Files and/or paths to watch. When changes are detected and paths match the defined entries within this option then the input file will be processed.\n\nPlease note that you do not need to include the input file within this configuration setting, Syncify will automatically apply this.",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "include": {
            "description": "Define a list of include paths. These will be passed to SASS and are useful when you want to include \"node_modules\" within @import references. You will need to prefex import paths with ~ character to inform Syncify to resolve imports from \"node_modules\" directory.",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "sass": {
            "description": "For compiling SASS Syncify uses Dart SASS. You can inform Syncify to pass through additional options to the compilers instance, like (for example) disabling warnings.",
            "type": "object",
            "properties": {
              "sourcemap": {
                "description": "Whether or not to generate a source maps. Syncify stores source maps locally within your projects \"node_modules/.cache/.syncify\" directory.",
                "type": "boolean",
                "default": true
              },
              "style": {
                "description": "Inform Dart SASS on how you wish to compiled CSS to output. By default, this is set to \"compressed\" so as provide Shopify with the smallest file size when uploading and downloading from store/s.\n\nPlease note, you should use PostCSS for post-processing styles.",
                "type": "string",
                "oneOf": [
                  {
                    "enum": ["compressed"]
                  },
                  {
                    "enum": ["expanded"]
                  }
                ]
              },
              "warnings": {
                "type": "boolean",
                "default": true,
                "description": "Whether or not you wish to disable warnings printed by Dart SASS. By default, this is set to \"true\" so warnings will be printed. When \"false\" Syncify will omit warnings from Dart SASS."
              }
            }
          },
          "postcss": {
            "default": "development",
            "description": "Control PostCSS execution when bundling SASS/SCSS. If you setup PostCSS within your workspace then by default Syncify will pass your compiled SASS to PostCSS for post-processing. This might not always be ideal as larger stylesheets will take longer to transform as they will need to pass through both the Dart SASS and PostCSS compilers.\n\nYou can optionally execute PostCSS to run only when transforms are running in \"production\" mode.",
            "oneOf": [
              {
                "enum": ["development"]
              },
              {
                "enum": ["production"]
              }
            ]
          }
        },
        "if": {
          "properties": {
            "input": {
              "type": "array"
            }
          }
        },
        "then": {
          "properties": {
            "rename": {
              "description": "Rename the stylesheet before uploading to theme assets.",
              "type": "object",
              "properties": {
                "prefix": {
                  "type": "string",
                  "description": "Prefix compiled CSS stylesheets name"
                },
                "prefixDir": {
                  "type": "boolean",
                  "description": "Whether or not to prefix the parent directory to the file name.",
                  "default": false
                }
              },
              "if": {
                "properties": {
                  "prefixDir": {
                    "const": true
                  }
                }
              },
              "then": {
                "properties": {
                  "separator": {
                    "description": "Optionally provide a prefix separator to be appended to the directory name of the CSS file.",
                    "type": "string"
                  }
                }
              }
            },
            "snippet": {
              "description": "Whether or not to output the contents of the stylesheet as a snippet. When \"true\" the transformed CSS will be wrapped in <style></style> tags and published to the theme \"snippets\" directory opposed to the theme \"assets\" directory.",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "else": {
          "properties": {
            "rename": {
              "description": "Rename the stylesheet before uploading to theme assets.",
              "type": "string"
            },
            "snippet": {
              "description": "Whether or not to output the contents of the stylesheet as a snippet. When \"true\" the transformed CSS will be wrapped in <style></style> tags and published to the theme \"snippets\" directory opposed to the theme \"assets\" directory.",
              "type": "boolean"
            }
          }
        }
      }
    },
    "json": {
      "description": "Transform options for handling \".json\" files. The configuration options you define here will be applied to all JSON file types intercepted by Syncify.",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "spaces": {
          "type": "number",
          "maximum": 5,
          "minimum": 1,
          "default": 2,
          "description": "An optional spaces preset which will ensure JSON files are published with this indentation level."
        },
        "minify": {
          "required": ["apply"],
          "type": "object",
          "description": "Minification options to be applied to JSON files. The settings defined here will be applied to all intercepted JSON files.",
          "additionalProperties": false,
          "properties": {
            "exclude": {
              "description": "An optional list of files which you wish to exclude from minification.",
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "removeSchemaRefs": {
              "type": "boolean",
              "default": true,
              "description": "When \"true\" Syncify will look for the existence of a \"$schema\" field in JSON files. If one is detected it will be removed before uploading."
            },
            "apply": {
              "type": "string",
              "default": "production",
              "description": "When to apply minification to JSON files.",
              "oneOf": [
                {
                  "enum": ["always"],
                  "description": "Always apply minification to JSON files, regardless of ENV flag."
                },
                {
                  "enum": ["production"],
                  "description": "Only apply minification to JSON files when the production flag is present."
                },
                {
                  "enum": ["never"],
                  "description": "Minification is never applied to JSON files."
                }
              ]
            }
          }
        }
      }
    },
    "icons": {
      "type": "object",
      "description": "Transform options for \".svg\" files. Generate an svg sprite or svg snippet files.",
      "additionalProperties": false,
      "properties": {
        "sprites": {
          "type": "array",
          "description": "Generate SVG Sprites. Sprites will be exported as a snippet.",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["input", "output"],
            "properties": {
              "input": {
                "description": "Path to SVG files",
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "output": {
                "type": "string",
                "description": "The name of the generated snippet file"
              },
              "options": {
                "type": "object",
                "additionalProperties": false,
                "description": "Syncify exposes only a couple of options when generating SVG Sprites. These options are passed to \"svg-sprites\".",
                "properties": {
                  "namespaceIDS": {
                    "type": "boolean",
                    "default": false,
                    "description": "In order to avoid ID clashes, the default behavior is to namespace all IDs in the source SVGs before compiling them into a sprite. Each ID is prepended with a unique string."
                  },
                  "dimensionAttributes": {
                    "type": "boolean",
                    "default": true,
                    "description": "If truthy, width and height attributes will be set on the sprite's element (where applicable)."
                  },
                  "rootAttributes": {
                    "type": "object",
                    "default": {},
                    "description": "Shorthand for applying custom attributes to the outermost element. Please be aware that certain attributes (e.g. viewBox) will be calculated dynamically and override custom rootAttributes in any case."
                  },
                  "namespaceClassnames": {
                    "type": "boolean",
                    "default": false,
                    "description": "In order to avoid CSS class name ambiguities, the default behavior is to namespace CSS class names in the source SVGs before compiling them into a sprite. Each class name is prepended with a unique string. Disable this option to keep the class names untouched."
                  }
                }
              }
            }
          }
        },
        "inline": {
          "type": "array",
          "description": "Generates an SVG snippet from the defined SVG file paths. You can customize how each SVG file is transformed by providing an \"svgo.config.js\" configuration file in your projects root directory or the defined \"config\" directory.",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "views": {
      "type": "object",
      "additionalProperties": false,
      "description": "Transform options for Liquid/HTML files",
      "properties": {
        "sections": {
          "type": "object",
          "additionalProperties": false,
          "description": "Section specific transform options when processing section theme files.",
          "properties": {
            "allowPrefix": {
              "type": "boolean",
              "default": true,
              "description": "Sections can be structured within sub-directories. If a section file is determined to be deeply nested in such a way then this option will enable parent directory name prefixing to be applied the filenames. For example,\n\nIf a section path is \"theme/sections/index/some-file.liquid\" then the filename will be prefixed with \"index\" so when referencing it within themes you'd need to use \"index_some-file.liquid\"\n\nPrefixing is helpful when you have a large number of sections and want to avoid name collusions. You can only control what sub-directories should have prefexing applied using the \"global:[]\" option or alternatively do not reference paths to sections which contain sub directories."
            },
            "onlyPrefixDuplicates": {
              "type": "boolean",
              "default": false,
              "description": "When \"allowPrefix\" is enabled and this is set to \"true\" then all files names will skip prefixing unless duplicates exists."
            },
            "prefixSeparator": {
              "type": "string",
              "default": "_",
              "description": "Define a separator character to be used for prefixing",
              "oneOf": [
                {
                  "enum": ["-"]
                },
                {
                  "enum": ["_"]
                }
              ]
            },
            "globals": {
              "description": "Glob path to files to section directories that should skip prefixing when a sub-directory structure is detected.",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "minify": {
          "type": "object",
          "required": ["env"],
          "additionalProperties": false,
          "description": "Minification options to be applied to Liquid/HTML files.",
          "properties": {
            "env": {
              "type": "string",
              "default": "production",
              "description": "When to apply minification to Liquid/HTML files.",
              "oneOf": [
                {
                  "enum": ["any"],
                  "description": "Always apply minification to Liquid/HTML files, regardless of the environment variable."
                },
                {
                  "enum": ["production"],
                  "description": "Only apply minification to Liquid/HTML files when the \"production\" or \"staging\" environment variable is present."
                },
                {
                  "enum": ["development"],
                  "description": "Only apply minification to Liquid/HTML files when the \"development\" environment variable is present."
                },
                {
                  "enum": ["never"],
                  "description": "Minification is never applied to Liquid/HTML files."
                }
              ]
            },
            "exclude": {
              "description": "A list of files or paths to be excluded from minification",
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "minifyJS": {
              "type": "boolean",
              "default": true,
              "description": "Whether or not the contents of <s></script> should be minified."
            },
            "minifyCSS": {
              "type": "boolean",
              "default": true,
              "description": "Whether or not the contents of <style></style> should be minified."
            },
            "removeComments": {
              "type": "boolean",
              "default": true,
              "description": "Whether or not to remove HTML comments"
            },
            "collapseWhitespace": {
              "type": "boolean",
              "default": true,
              "description": "Should whitespace be collapsed"
            },
            "trimCustomFragments": {
              "type": "boolean",
              "default": true
            },
            "caseSensitive": {
              "type": "boolean",
              "description": "Treat attributes in case sensitive manner (useful for custom HTML tags)",
              "default": false
            },
            "omitBooleanValues": {
              "type": "boolean",
              "description": "Omit attribute values from boolean attributes",
              "default": false
            },
            "keepClosingSlash": {
              "type": "boolean",
              "description": "Keep the trailing slash on singleton elements",
              "default": false
            },
            "ignoreCustomFragments": {
              "description": "A regular expression list of HTML fragments to ignore. Please keep in mind that the expressions will be converted using new RegExp() method so ensure to escape character where necessary.",
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "sortAttributes": {
              "type": "boolean",
              "description": "Sort attributes by frequency",
              "default": false
            },
            "minifySectionSchema": {
              "type": "boolean",
              "default": true,
              "description": "Whether JSON section schema tag contents should be minified."
            },
            "removeRedundantAttributes": {
              "type": "boolean",
              "default": false,
              "description": "Remove attributes when value matches default"
            },
            "removeAttributeQuotes": {
              "type": "boolean",
              "description": "Remove quotes around HTML attributes when possible",
              "default": false
            },
            "removeLiquidNewlineAttributes": {
              "type": "boolean",
              "default": true,
              "description": "Whether or not to remove newlines contained within attributes. This is specifically helpful when you a expressing Liquid in HTML attributes that spans newlines."
            },
            "removeRedundantWhitespaceDashes": {
              "type": "boolean",
              "default": false,
              "description": "Whether or not to remove redundant whitespace dashes from Liquid tags when proceeding characters are not whitespace values."
            },
            "removeLiquidComments": {
              "type": "boolean",
              "default": false,
              "description": "Whether or not to remove Liquid comments"
            },
            "ignoredLiquidTags": {
              "description": "A list of Liquid tags to be ignored from minification",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "options": {
      "type": "object",
      "description": "Syncify Configuration options for Shopify theme development.",
      "required": ["stores"],
      "additionalProperties": false,
      "properties": {
        "dirs": {
          "$ref": "#/definitions/dirs"
        },
        "paths": {
          "$ref": "#/definitions/paths"
        },
        "stores": {
          "$ref": "#/definitions/stores"
        },
        "spawn": {
          "$ref": "#/definitions/spawn"
        },
        "metafields": {
          "type": "object",
          "description": "Metafields configuration settings to be applied to the metafield sync feature. Syncify uses a directory based JSON file approach for publishing metafields to and from stores.",
          "properties": {
            "input": {
              "description": "The input directory path relative to the root directory which syncify should sync metafields.",
              "type": ["object", "string"],
              "pattern": "^[/a-zA-Z0-9_-]+$"
            },
            "bind": {
              "type": "boolean",
              "default": false,
              "readOnly": true,
              "description": "NOT YET AVAILABLE\n\nWhether or not to bind metafields. When \"true\" the local metafields will be validated against the stores remote metafields. If your store metafield is determined to be updated more recently than you local version Syncify will update the source."
            }
          }
        },
        "transform": {
          "description": "Transform configuration options for processing in the asset and file pipeline.",
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "styles": {
              "$ref": "#/definitions/styles"
            },
            "json": {
              "$ref": "#/definitions/json"
            },
            "icons": {
              "$ref": "#/definitions/icons"
            },
            "views": {
              "$ref": "#/definitions/views"
            }
          }
        }
      }
    }
  },
  "type": "object",
  "required": ["syncify"],
  "properties": {
    "syncify": {
      "$ref": "#/definitions/options"
    }
  }
}
